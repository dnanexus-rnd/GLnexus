readme: |
  ## Why this is a problematic case
  We don't really understand why/when HaplotypeCaller does this, or what to do about it. Some unverified possibilities:
  > It has something to do with special attention paid to dbSNP alleles
  > They're a way of representing mutually exclusive haplotypes (not observed together in individual reads) in the intermediate data prior to unification
  > They represent uncertainty in HaplotypeCaller's local reassembly

  ## Overcoming this problem
  No concrete plans yet

  ## Included example
  A.gvcf, B.gvcf, C.gvcf = samples with entries in overlapping regions

  ## Explanation on included sample
  All samples have entries in overlapping gvcf region (A: 1000-1002)

input:
  header : |-
      ##fileformat=VCFv4.2
      ##FORMAT=<ID=GT,Number=1,Type=String,Description="Genotype">
      ##FORMAT=<ID=AD,Number=.,Type=Integer,Description="Allelic depths for the ref and alt alleles in the order listed">
      ##FORMAT=<ID=PL,Number=G,Type=Integer,Description="Normalized, Phred-scaled likelihoods for genotypes as defined in the VCF specification">
      ##FORMAT=<ID=GQ,Number=1,Type=Integer,Description="Genotype Quality">
      ##FORMAT=<ID=SB,Number=4,Type=Integer,Description="Per-sample component statistics which comprise the Fisher's Exact Test to detect strand bias.">
      ##FORMAT=<ID=DP,Number=1,Type=Integer,Description="Approximate read depth (reads with MQ=255 or with bad mates are filtered)">
      ##FORMAT=<ID=MIN_DP,Number=1,Type=Integer,Description="Minimum DP observed within the GVCF block">
      ##FILTER=<ID=PASS,Description="All filters passed">
      ##INFO=<ID=END,Number=1,Type=Integer,Description="Stop position of the interval">
      ##contig=<ID=A,length=1000000>
      #CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO	FORMAT
  body:
    - A.gvcf: |
        A
        A	1000	.	CAA	C,<NON_REF>	666.73	.	.	GT:AD:DP:GQ:PL:SB	0/1:148,33,0:181:99:704,0,6552,1150,6673,7822:1,147,33,0
        A	1002	.	A	ACCC,<NON_REF>	488.73	.	.	GT:AD:DP:GQ:PL:SB	0/1:145,25,0:170:99:526,0,6575,971,6673,7643:1,144,25,0
    - B.gvcf: |
        B
        A	1000	.	CAA	C,<NON_REF>	316.73	.	.	GT:AD:DP:GQ:PL:SB	0/1:169,22,0:191:99:354,0,7181,874,7283,8157:4,165,22,0
        A	1002	.	A	ACCC,<NON_REF>	64.73	.	.	GT:AD:DP:GQ:PL:SB	0/1:165,13,0:178:99:102,0,7156,616,7221,7837:3,162,13,0
    - C.gvcf: |
        C
        A	1000	.	CAA	C,<NON_REF>	311.73	.	.	GT:AD:DP:GQ:PL:SB	0/1:128,18,0:146:99:349,0,5216,739,5288,6028:2,126,18,0
        A	1002	.	A	ACCC,<NON_REF>	192.73	.	.	GT:AD:DP:GQ:PL:SB	0/1:125,14,0:139:99:230,0,5175,614,5229,5843:2,123,14,0

truth_unified_sites:
    - range: {ref: "A", beg: 1000, end: 1002}
      alleles: [CAA, C]
      observation_count: [3, 3]
      unification:
        - range: {beg: 1000, end: 1002}
          alt: CAA
          to: 0
        - range: {beg: 1000, end: 1002}
          alt: C
          to: 1

truth_output_vcf:
  - truth.vcf: |
      ##fileformat=VCFv4.2
      ##FILTER=<ID=PASS,Description="All filters passed">
      ##FORMAT=<ID=GT,Number=1,Type=String,Description="Genotype">
      ##FORMAT=<ID=RNC,Number=G,Type=Character,Description="Reason for No Call in GT: . = N/A, M = Missing data, L = Lost/unrepresentable allele">
      ##contig=<ID=A,length=1000000>
      #CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO	FORMAT	A	B	C
      A	1000	.	CAA	C	0	.	.	GT:RNC	0/1:..	0/1:..	0/1:..
